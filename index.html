<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Бронь переговорных — Прайм Самолет Плюс</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    html,body,#root{height:100%}
    .logo-fallback{font-weight:800;letter-spacing:.02em}
    img.hide-on-error{display:block}
    img.hide-on-error[aria-hidden="true"]{display:none}
    .noselect{-webkit-user-select:none;-ms-user-select:none;user-select:none}
  </style>
</head>
<body class="bg-slate-50 text-slate-900">
  <div id="root"></div>

  <script type="text/babel">
    const tg = window.Telegram?.WebApp; if (tg){ tg.ready(); tg.expand(); }
    const uid = () => Math.random().toString(36).slice(2,9)
    const toISODate = (d) => new Date(d).toISOString().slice(0,10)
    const hm2m = (hm)=>{ const [h,m] = (hm||'00:00').split(':').map(Number); return h*60+m }
    const m2hm = (m)=> `${String(Math.floor(m/60)).padStart(2,'0')}:${String(m%60).padStart(2,'0')}`
    const clamp = (v,min,max)=> Math.max(min, Math.min(max, v))

    const LS_KEY = 'roomie_ru_v3'
    const loadState = () => { try{ return JSON.parse(localStorage.getItem(LS_KEY))||null }catch{ return null } }
    const saveState = (s) => localStorage.setItem(LS_KEY, JSON.stringify(s))

    const defaultRooms = [
      {id:'r1', name:'Б1. Переговорная', capacity:6, equipment:['TV','HDMI']},
      {id:'r2', name:'Б2. Переговорная', capacity:10, equipment:['TV','HDMI','Камера']},
      {id:'r3', name:'Zoom-комната', capacity:2, equipment:['Наушники']},
    ]

    function App(){
      const [state, setState] = React.useState(()=> loadState() || {
        role:'user', pins:{admin:'0404', user:'0000'},
        rooms: defaultRooms,
        bookings: [], // {id, roomId, title, date, start, end, repeat, count, who}
        settings:{ workStart:'08:00', workEnd:'20:00', step:30 }
      })
      React.useEffect(()=> saveState(state), [state])

      const [showAuth,setShowAuth] = React.useState(false)
      const [showAdmin,setShowAdmin] = React.useState(false)
      const [editing,setEditing] = React.useState(null)

      const isAdmin = state.role==='admin'
      const setSettings = (p)=> setState(s=>({...s, settings:{...s.settings, ...p}}))
      const setRooms = (rooms)=> setState(s=>({...s, rooms}))

      function addBooking(b){ setState(prev=> ({...prev, bookings:[...prev.bookings, {...b, id:uid(), who: tg?.initDataUnsafe?.user?.username||'you'}]})) }
      function removeBooking(id){ setState(p=> ({...p, bookings:p.bookings.filter(x=>x.id!==id)})) }
      function updateBooking(patch){ setState(p=> ({...p, bookings:p.bookings.map(b=> b.id===patch.id? {...b, ...patch}: b)})) }

      function sendToBot(){
        try{
          const payload = { type:'sync_calendar', bookings: state.bookings }
          if (tg){ tg.sendData(JSON.stringify(payload)); tg.showPopup({title:'Отправлено',message:'Бронирования отправлены в бота для синхронизации с календарём.',buttons:[{type:'ok'}]}) }
        }catch(e){ alert('Не удалось отправить: '+e.message) }
      }

      return (
        <div className="min-h-full max-w-5xl mx-auto p-4 sm:p-6">
          <Header onAuth={()=>setShowAuth(true)} role={state.role} />

          <div className="grid lg:grid-cols-2 gap-4 mt-4">
            <Card>
              <h2 className="text-lg font-semibold">Новая бронь</h2>
              <NewBooking rooms={state.rooms} step={state.settings.step} onCreate={(b)=>{
                const list = expandRecurring(b)
                list.forEach(addBooking)
                tg?.HapticFeedback?.impactOccurred('medium')
              }} />
            </Card>

            <Card>
              <div className="flex items-start justify-between gap-2">
                <h2 className="text-lg font-semibold">Мои брони</h2>
                <div className="flex gap-2">
                  <Button onClick={sendToBot}>Синхронизировать с календарём</Button>
                  <a className="inline-flex items-center px-3 py-2 rounded-xl border bg-white text-sm hover:bg-slate-50" download="bookings.csv" href={csvHref(state.bookings)}>Экспорт CSV</a>
                </div>
              </div>
              <BookingList isAdmin={isAdmin} rooms={state.rooms} items={state.bookings}
                onDelete={removeBooking} onEdit={setEditing} />
            </Card>
          </div>

          <Card className="mt-4">
            <div className="flex items-center justify-between mb-3">
              <h2 className="text-lg font-semibold">Календарь по переговорным</h2>
              {isAdmin && <Button onClick={()=>setShowAdmin(true)}>Админ-панель</Button>}
            </div>
            <CalendarView rooms={state.rooms} bookings={state.bookings} settings={state.settings} onEdit={setEditing} onDragSave={updateBooking} />
          </Card>

          {showAuth && (
            <AuthDialog pins={state.pins} onClose={()=>setShowAuth(false)} onSubmit={(p)=>{
              if (p===state.pins.admin){ setState(s=>({...s, role:'admin'})); setShowAuth(false) }
              else if (p===state.pins.user){ setState(s=>({...s, role:'user'})); setShowAuth(false) }
              else alert('Неверный PIN')
            }} />
          )}

          {showAdmin && (
            <AdminPanel onClose={()=>setShowAdmin(false)} pins={state.pins} settings={state.settings} rooms={state.rooms}
              onPins={(pins)=> setState(s=>({...s, pins}))}
              onSettings={setSettings} onRooms={setRooms}
              onImport={(json)=> setState(s=>({...s, ...json}))} />
          )}

          {editing && (
            <EditDialog booking={editing} rooms={state.rooms} step={state.settings.step}
              onClose={()=>setEditing(null)}
              onSave={(patch)=>{ updateBooking(patch); setEditing(null) }}
              onDelete={()=>{ removeBooking(editing.id); setEditing(null) }} />
          )}
        </div>
      )
    }

    function Header({onAuth, role}){
      const [imgHidden, setImgHidden] = React.useState(false)
      return (
        <header className="flex items-center justify-between gap-3">
          <div className="flex items-center gap-3">
            <img src="logo.png" alt="Логотип" className="h-10 w-10 rounded-md hide-on-error" aria-hidden={imgHidden}
                 onError={()=>setImgHidden(true)} />
            {!imgHidden && <span className="sr-only">Прайм Самолет Плюс</span>}
            {imgHidden && (
              <div className="logo-fallback text-xl">прайм самолёт <span className="px-2 py-0.5 rounded bg-black text-white ml-1">плюс</span></div>
            )}
          </div>
          <div className="flex items-center gap-2">
            <span className="text-xs text-slate-500">Роль: {role==='admin' ? 'Админ' : 'Пользователь'}</span>
            <Button onClick={onAuth}>{role==='admin'?'Сменить роль':'Войти по PIN'}</Button>
          </div>
        </header>
      )
    }

    function Card({children, className=''}){ return <section className={"p-4 sm:p-5 bg-white rounded-2xl shadow border "+className}>{children}</section> }
    function Button({children, className='', ...props}){ return <button className={"inline-flex items-center justify-center px-3 py-2 rounded-xl bg-slate-900 text-white text-sm hover:bg-black active:opacity-90 "+className} {...props}>{children}</button> }

    function AuthDialog({pins, onClose, onSubmit}){
      const [v,setV] = React.useState('')
      return (
        <div className="fixed inset-0 z-50 grid place-items-center bg-black/40 p-4" role="dialog">
          <div className="w-full max-w-sm bg-white rounded-2xl p-5 shadow-xl">
            <h3 className="text-lg font-semibold mb-3">Авторизация по PIN</h3>
            <input className="w-full border rounded-xl px-3 py-2 mb-3" value={v} inputMode="numeric" maxLength={8} placeholder="Введите PIN (админ: 0404)"
                   onChange={(e)=>setV(e.target.value)} />
            <div className="flex gap-2 justify-end">
              <button className="px-3 py-2 text-sm" onClick={onClose}>Отмена</button>
              <Button onClick={()=>onSubmit(v)}>Войти</Button>
            </div>
          </div>
        </div>
      )
    }

    function NewBooking({rooms, onCreate, step=30}){
      const today = toISODate(new Date())
      const [form,setForm] = React.useState({ title:'Бронь переговорной', roomId: rooms[0]?.id, date: today, start:'10:00', end:'11:00', repeat:'none', count:1 })
      React.useEffect(()=>{ if (tg){ tg.MainButton.setParams({text:'Создать бронь'}); tg.MainButton.onClick(()=> handleCreate()); tg.MainButton.show(); return ()=> tg.MainButton.hide() } }, [form])
      function handleCreate(){ if(!form.roomId) return alert('Выберите переговорную'); if(form.start>=form.end) return alert('Время окончания должно быть позже начала'); onCreate({...form}) }
      return (
        <div className="grid sm:grid-cols-2 gap-3">
          <div>
            <label className="block text-xs text-slate-500 mb-1">Переговорная</label>
            <select className="w-full border rounded-xl px-3 py-2" value={form.roomId} onChange={e=>setForm(f=>({...f, roomId:e.target.value}))}>
              {rooms.map(r=> <option value={r.id} key={r.id}>{r.name} · {r.capacity} мест</option>)}
            </select>
          </div>
          <div>
            <label className="block text-xs text-slate-500 mb-1">Название</label>
            <input className="w-full border rounded-xl px-3 py-2" value={form.title} onChange={e=>setForm(f=>({...f, title:e.target.value}))} />
          </div>
          <div>
            <label className="block text-xs text-slate-500 mb-1">Дата</label>
            <input type="date" className="w-full border rounded-xl px-3 py-2" value={form.date} onChange={e=>setForm(f=>({...f, date:e.target.value}))} />
          </div>
          <div className="grid grid-cols-2 gap-2">
            <div>
              <label className="block text-xs text-slate-500 mb-1">Начало</label>
              <input type="time" step={step*60} className="w-full border rounded-xl px-3 py-2" value={form.start} onChange={e=>setForm(f=>({...f, start:e.target.value}))} />
            </div>
            <div>
              <label className="block text-xs text-slate-500 mb-1">Окончание</label>
              <input type="time" step={step*60} className="w-full border rounded-xl px-3 py-2" value={form.end} onChange={e=>setForm(f=>({...f, end:e.target.value}))} />
            </div>
          </div>
          <div>
            <label className="block text-xs text-slate-500 mb-1">Повтор</label>
            <select className="w-full border rounded-xl px-3 py-2" value={form.repeat} onChange={e=>setForm(f=>({...f, repeat:e.target.value}))}>
              <option value="none">Без повтора</option>
              <option value="daily">Каждый день</option>
              <option value="weekly">Каждую неделю</option>
            </select>
          </div>
          <div>
            <label className="block text-xs text-slate-500 mb-1">Количество повторов</label>
            <input type="number" min={1} max={60} className="w-full border rounded-xl px-3 py-2" value={form.count} onChange={e=>setForm(f=>({...f, count:Number(e.target.value||1)}))} />
          </div>
          <div className="sm:col-span-2 flex gap-2">
            <Button onClick={handleCreate}>Создать бронь</Button>
            <a className="inline-flex items-center px-3 py-2 rounded-xl border bg-white text-sm hover:bg-slate-50" download="booking.ics" href={icsHref(form)}>Скачать .ics</a>
          </div>
        </div>
      )
    }

    function expandRecurring(b){ const list=[]; const base=new Date(b.date+'T'+b.start); for(let i=0;i<(b.count||1);i++){ const d=new Date(base); if(b.repeat==='daily') d.setDate(d.getDate()+i); else if(b.repeat==='weekly') d.setDate(d.getDate()+7*i); list.push({...b, date:toISODate(d)}) } return list }

    function BookingList({rooms, items, onDelete, isAdmin, onEdit}){
      if (!items.length) return <p className="text-sm text-slate-500">Пока нет броней.</p>
      const byDate = [...items].sort((a,b)=> (a.date+a.start).localeCompare(b.date+b.start))
      const roomName = (id)=> rooms.find(r=>r.id===id)?.name||'—'
      const me = tg?.initDataUnsafe?.user?.username
      const canDelete = (b)=> isAdmin || (me && b.who===me)
      return (
        <ul className="divide-y">
          {byDate.map(b=> (
            <li key={b.id} className="py-3 flex items-center justify-between gap-3">
              <div>
                <div className="font-medium cursor-pointer" onClick={()=>onEdit?.(b)}>{b.title}</div>
                <div className="text-xs text-slate-500">{roomName(b.roomId)} · {fmtDate(b.date)} · {b.start}–{b.end}</div>
              </div>
              <div className="flex gap-2 items-center">
                <span className="text-xs text-slate-400">{b.who||'—'}</span>
                <a className="px-3 py-2 rounded-xl border text-sm" download={`booking-${b.id}.ics`} href={icsHref(b)}>ICS</a>
                {canDelete(b) && <button className="px-3 py-2 rounded-xl border text-sm" onClick={()=>onDelete(b.id)}>Удалить</button>}
              </div>
            </li>
          ))}
        </ul>
      )
    }

    function CalendarView({rooms, bookings, settings, onEdit, onDragSave}){
      const [date, setDate] = React.useState(toISODate(new Date()))
      const dayStart = hm2m(settings.workStart||'08:00'), dayEnd = hm2m(settings.workEnd||'20:00')
      const step = settings.step || 30
      const totalMin = Math.max(step, dayEnd-dayStart)
      const slots = []; for(let h=Math.floor(dayStart/60); h<=Math.floor(dayEnd/60); h++){ slots.push(`${String(h).padStart(2,'0')}:00`) }
      const pxPerHour = 40; const gridH = pxPerHour*slots.length

      const [drag,setDrag] = React.useState(null) // {id, roomId, duration, offsetY}

      function startDrag(e, b){
        const duration = hm2m(b.end)-hm2m(b.start)
        const rect = e.currentTarget.parentElement.getBoundingClientRect()
        const y = e.clientY - rect.top
        setDrag({ id:b.id, roomId:b.roomId, duration, offset: y - ((hm2m(b.start)-dayStart)/totalMin)*gridH })
        document.addEventListener('mousemove', onMove)
        document.addEventListener('mouseup', onUp)
      }
      function onMove(e){ setDrag(d=> d? {...d, y:e.clientY}: null) }
      function onUp(){ if(!drag){ cleanup(); return } const rect = document.querySelector('[data-calendar-grid]')?.getBoundingClientRect(); if(!rect){ cleanup(); return }
        const y = clamp(drag.y - rect.top - drag.offset, 0, gridH - 10)
        const ratio = y / gridH
        const startMinRaw = dayStart + Math.round((ratio * totalMin) / step) * step
        const endMin = Math.min(dayEnd, startMinRaw + drag.duration)
        const startMin = Math.max(dayStart, endMin - drag.duration)
        onDragSave?.({ id:drag.id, start:m2hm(startMin), end:m2hm(endMin) })
        cleanup()
      }
      function cleanup(){ document.removeEventListener('mousemove', onMove); document.removeEventListener('mouseup', onUp); setDrag(null) }

      return (
        <div className="grid gap-3">
          <div className="flex items-center gap-2">
            <input type="date" className="border rounded-xl px-3 py-2" value={date} onChange={(e)=>setDate(e.target.value)} />
            <span className="text-xs text-slate-500">Показываем {rooms.length} переговорных</span>
          </div>

          {rooms.map(room=>{
            const list = bookings.filter(b=> b.roomId===room.id && b.date===date)
            return (
            <div key={room.id} className="border rounded-2xl overflow-hidden">
              <div className="px-3 py-2 bg-slate-100 text-sm font-medium">{room.name} · {room.capacity} мест</div>
              <div className="relative">
                <div className="grid" style={{gridTemplateColumns:`80px 1fr`}}>
                  <div className="bg-white">
                    {slots.map((t,i)=> (<div key={i} className="h-10 text-[11px] text-right pr-2 leading-10 text-slate-400 border-b">{t}</div>))}
                  </div>
                  <div className="relative bg-white noselect" style={{height:gridH}} data-calendar-grid>
                    {slots.map((_,i)=> <div key={i} className="h-10 border-b" />)}
                    {list.map(b=>{
                      const top = ((hm2m(b.start)-dayStart)/totalMin)*gridH
                      const h = ((hm2m(b.end)-hm2m(b.start))/totalMin)*gridH
                      return (
                        <div key={b.id} className="absolute left-2 right-2 bg-indigo-600/10 border border-indigo-500/40 rounded-lg p-2 text-[12px] cursor-grab active:cursor-grabbing"
                             style={{top:top, height:Math.max(28,h)}} onMouseDown={(e)=>startDrag(e,b)} onDoubleClick={()=>onEdit?.(b)}>
                          <div className="font-medium text-indigo-800 truncate">{b.title}</div>
                          <div className="text-[11px] text-indigo-900/70">{b.start}–{b.end} · {b.who||'—'}</div>
                        </div>
                      )
                    })}
                  </div>
                </div>
              </div>
            </div>)
          })}
        </div>
      )
    }

    function AdminPanel({onClose, pins, rooms, settings, onPins, onRooms, onSettings, onImport}){
      const [apins, setApins] = React.useState(pins)
      const [list, setList] = React.useState(rooms)
      const [cfg, setCfg] = React.useState(settings)
      function addRoom(){ setList(l=>[...l,{id:uid(), name:'Новая переговорная', capacity:4, equipment:[] }]) }
      function save(){ onPins(apins); onRooms(list); onSettings(cfg); onClose() }
      function exportJson(){ const data = JSON.stringify({pins:apins, rooms:list, settings:cfg}, null, 2); const url = 'data:application/json;charset=utf-8,'+encodeURIComponent(data); const a=document.createElement('a'); a.href=url; a.download='roomie-export.json'; a.click() }
      function onFile(e){ const f=e.target.files?.[0]; if(!f) return; const rdr=new FileReader(); rdr.onload=()=>{ try{ const j=JSON.parse(rdr.result); onImport?.(j); alert('Импортировано'); onClose() }catch{ alert('Не удалось импортировать') } }; rdr.readAsText(f) }
      return (
        <div className="fixed inset-0 z-50 grid place-items-center bg-black/40 p-4">
          <div className="w-full max-w-3xl bg-white rounded-2xl p-5 shadow-xl grid gap-4">
            <div className="flex justify-between items-center">
              <h3 className="text-lg font-semibold">Админ-панель</h3>
              <button onClick={onClose} className="text-sm">Закрыть</button>
            </div>
            <div className="grid md:grid-cols-2 gap-4">
              <section>
                <h4 className="font-medium mb-2">PIN-коды</h4>
                <label className="block text-xs text-slate-500 mb-1">Админ</label>
                <input className="w-full border rounded-xl px-3 py-2 mb-2" value={apins.admin} onChange={e=>setApins(p=>({...p, admin:e.target.value}))} />
                <label className="block text-xs text-slate-500 mb-1">Пользователь</label>
                <input className="w-full border rounded-xl px-3 py-2" value={apins.user} onChange={e=>setApins(p=>({...p, user:e.target.value}))} />

                <h4 className="font-medium mt-4 mb-2">Настройки времени</h4>
                <div className="grid grid-cols-3 gap-2">
                  <div>
                    <label className="block text-xs text-slate-500 mb-1">Начало</label>
                    <input type="time" className="w-full border rounded-xl px-3 py-2" value={cfg.workStart} onChange={e=>setCfg(c=>({...c, workStart:e.target.value}))} />
                  </div>
                  <div>
                    <label className="block text-xs text-slate-500 mb-1">Окончание</label>
                    <input type="time" className="w-full border rounded-xl px-3 py-2" value={cfg.workEnd} onChange={e=>setCfg(c=>({...c, workEnd:e.target.value}))} />
                  </div>
                  <div>
                    <label className="block text-xs text-slate-500 mb-1">Шаг</label>
                    <select className="w-full border rounded-xl px-3 py-2" value={cfg.step} onChange={e=>setCfg(c=>({...c, step:Number(e.target.value)}))}>
                      <option value={15}>15 мин</option>
                      <option value={30}>30 мин</option>
                      <option value={60}>60 мин</option>
                    </select>
                  </div>
                </div>

                <div className="mt-4 flex gap-2">
                  <Button onClick={exportJson}>Экспорт настроек</Button>
                  <label className="inline-flex items-center px-3 py-2 rounded-xl border bg-white text-sm hover:bg-slate-50 cursor-pointer">Импорт JSON
                    <input type="file" accept="application/json" className="hidden" onChange={onFile} />
                  </label>
                </div>
              </section>
              <section>
                <h4 className="font-medium mb-2">Переговорные</h4>
                <div className="grid gap-2">
                  {list.map(r=> (
                    <div key={r.id} className="border rounded-xl p-3 grid grid-cols-5 gap-2 items-center">
                      <input className="col-span-3 border rounded-xl px-3 py-2" value={r.name} onChange={e=>setList(a=> a.map(x=> x.id===r.id? {...x, name:e.target.value}: x))} />
                      <input type="number" className="border rounded-xl px-3 py-2" value={r.capacity} onChange={e=>setList(a=> a.map(x=> x.id===r.id? {...x, capacity:Number(e.target.value)}: x))} />
                      <button className="text-sm" onClick={()=> setList(a=> a.filter(x=> x.id!==r.id))}>Удалить</button>
                    </div>
                  ))}
                  <Button onClick={addRoom}>Добавить переговорную</Button>
                </div>
              </section>
            </div>
            <div className="flex justify-end gap-2">
              <button className="px-3 py-2" onClick={onClose}>Отмена</button>
              <Button onClick={save}>Сохранить</Button>
            </div>
          </div>
        </div>
      )
    }

    function EditDialog({booking, rooms, step=30, onClose, onSave, onDelete}){
      const [f,setF] = React.useState({...booking})
      return (
        <div className="fixed inset-0 z-50 grid place-items-center bg-black/40 p-4">
          <div className="w-full max-w-md bg-white rounded-2xl p-5 shadow-xl grid gap-3">
            <h3 className="text-lg font-semibold">Редактирование брони</h3>
            <select className="w-full border rounded-xl px-3 py-2" value={f.roomId} onChange={e=>setF(o=>({...o, roomId:e.target.value}))}>
              {rooms.map(r=> <option key={r.id} value={r.id}>{r.name}</option>)}
            </select>
            <input type="text" className="w-full border rounded-xl px-3 py-2" value={f.title} onChange={e=>setF(o=>({...o, title:e.target.value}))} />
            <input type="date" className="w-full border rounded-xl px-3 py-2" value={f.date} onChange={e=>setF(o=>({...o, date:e.target.value}))} />
            <div className="grid grid-cols-2 gap-2">
              <input type="time" step={step*60} className="w-full border rounded-xl px-3 py-2" value={f.start} onChange={e=>setF(o=>({...o, start:e.target.value}))} />
              <input type="time" step={step*60} className="w-full border rounded-xl px-3 py-2" value={f.end} onChange={e=>setF(o=>({...o, end:e.target.value}))} />
            </div>
            <div className="flex justify-between gap-2">
              <button className="px-3 py-2" onClick={onClose}>Отмена</button>
              <div className="flex gap-2">
                <button className="px-3 py-2 rounded-xl border" onClick={onDelete}>Удалить</button>
                <Button onClick={()=>onSave(f)}>Сохранить</Button>
              </div>
            </div>
          </div>
        </div>
      )
    }

    function fmtDate(d){ const dd=new Date(d+'T00:00:00'); return dd.toLocaleDateString('ru-RU',{day:'2-digit',month:'2-digit',year:'numeric'}) }
    function csvHref(list){ if(!list?.length) return 'data:text/plain;charset=utf-8,'+encodeURIComponent(''); const header=['title','room','date','start','end']; const rows=list.map(b=>[b.title,b.roomId,b.date,b.start,b.end]); const all=[header,...rows].map(r=> r.map(v=>'"'+String(v).replaceAll('"','""')+'"').join(',')).join('\n'); return 'data:text/csv;charset=utf-8,'+encodeURIComponent(all) }
    function icsHref(b){ const dt=(d,t)=> d.replaceAll('-','')+'T'+t.replace(':','')+'00'; const ics=['BEGIN:VCALENDAR','VERSION:2.0','PRODID:-//Roomie RU//EN','CALSCALE:GREGORIAN','BEGIN:VEVENT','UID:'+uid()+'@roomie','DTSTAMP:'+dt(toISODate(new Date()), new Date().toTimeString().slice(0,5)),'DTSTART:'+dt(b.date,b.start),'DTEND:'+dt(b.date,b.end),'SUMMARY:'+b.title,'DESCRIPTION:Переговорная','END:VEVENT','END:VCALENDAR'].join('\r\n'); return 'data:text/calendar;charset=utf-8,'+encodeURIComponent(ics) }

    const root = ReactDOM.createRoot(document.getElementById('root'))
    root.render(<App />)
  </script>
</body>
</html>
